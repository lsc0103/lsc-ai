# PM 指令 — 产品业务验收（Phase G：上线前闭环验证）

**下达人**: Claude Opus 4.6 (产品总经理)
**接收人**: 本地总工程师 + 全体开发团队
**日期**: 2026-02-07
**性质**: 最高优先级 — 所有新功能开发暂停，先完成业务验收
**原则**: 不是测代码能不能跑，而是测用户能不能用

---

## 背景

我们有 169 个 E2E 测试、7 项修复、14/16 S04 通过率。但这些都是**技术指标**。

一个舟山中远海运重工的员工打开 LSC-AI，能不能完成他的实际工作？这个问题我们没有回答过。

**从今天起，验收标准从"测试通过"变为"业务闭环"。**

---

## 验收范围

只验收当前已实现的功能（不涉及 RPA/Sentinel/RAG/系统对接）：

| 业务链路 | 描述 | 验收标准 |
|---------|------|---------|
| BF-1 | 基础对话体验 | 用户能流畅对话，AI 响应合理 |
| BF-2 | Workbench 数据可视化 | 用户说"表格/图表/代码"，AI 正确调用工具并渲染 |
| BF-3 | Office 文档生成 | 用户要文档，AI 生成可下载的 Word/Excel/PDF |
| BF-4 | 本地 Agent 文件操作 | 用户连本地 Agent，AI 能操作本地文件 |
| BF-5 | 会话管理与记忆 | 会话切换、历史恢复、上下文连贯 |
| BF-6 | 完整工作场景 | 跨功能组合：对话 + Workbench + 文档 + 文件操作 |

---

## BF-1：基础对话体验

**用户故事**: 员工打开 LSC-AI，想问 AI 一些问题，获得有用的回答。

### 验收用例

| 编号 | 操作 | 预期结果 | 判定标准 |
|------|------|---------|---------|
| BF-1.1 | 登录系统 | 看到聊天界面，可以输入 | 3 秒内加载完成 |
| BF-1.2 | 发送"你好，介绍一下你自己" | AI 自我介绍为 LSC-AI 助手 | 回复在 10 秒内开始流式输出 |
| BF-1.3 | 发送"帮我写一封请假邮件，理由是家里有事，请假两天" | AI 生成格式正确的邮件内容 | 邮件有称呼、正文、落款 |
| BF-1.4 | 发送"上一封邮件改成英文" | AI 翻译上文的邮件 | 证明多轮上下文有效 |
| BF-1.5 | 发送一条超长消息（500 字以上） | AI 正常处理并回复 | 不截断、不报错 |
| BF-1.6 | 快速连发 3 条消息 | 系统不崩溃，消息不丢失 | 每条都有回复或有合理的排队提示 |

**通过标准**: 6/6 全过

---

## BF-2：Workbench 数据可视化

**用户故事**: 生产经理想看数据分析结果，希望 AI 用表格、图表展示。

**这是当前已知最薄弱的环节。** AI 的工具调用率不稳定。

### 验收用例

| 编号 | 用户输入（必须完全按这个发） | 预期结果 | 判定标准 |
|------|--------------------------|---------|---------|
| BF-2.1 | "用表格展示以下数据：2024年每个季度的销售额分别是120万、150万、180万、200万" | Workbench 面板打开，显示表格 | Workbench 可见 + 表格有 4 行数据 |
| BF-2.2 | "用柱状图展示上面的季度销售数据" | Workbench 显示柱状图 | 图表渲染 + 4 个柱子 |
| BF-2.3 | "展示一段 Python 快速排序的代码" | Workbench 显示代码块 | 代码高亮 + 语法正确 |
| BF-2.4 | "用工作台同时展示：1.一个季度销售表格 2.对应的折线图 3.分析总结" | Workbench 多 Tab 展示 | 至少 2 个 Tab 可见 |
| BF-2.5 | 关闭 Workbench 面板，再发送"重新展示刚才的表格" | Workbench 重新打开 | 关闭→重开流程正常 |

**通过标准**: ≥ 4/5。BF-2.4 允许部分通过（至少 1 个 Tab 有内容）。

**关键观察**：如果 AI 返回的是 Markdown 文本表格而不是 Workbench 面板，记为**不通过**并记录 AI 实际回复。这是产品核心价值——"看"的能力——如果 AI 不调用工具，用户得到的体验跟普通聊天机器人没区别。

---

## BF-3：Office 文档生成

**用户故事**: 员工需要 AI 帮忙生成一份工作报告、一个数据表格。

### 验收用例

| 编号 | 用户输入 | 预期结果 | 判定标准 |
|------|---------|---------|---------|
| BF-3.1 | "帮我写一份项目周报的 Word 文档，项目名'船舶改造'，本周完成了设计评审和材料采购" | 生成 .docx 文件 | 文件可下载 + 内容包含项目名和本周事项 |
| BF-3.2 | "创建一个 Excel 表格，包含5个员工的姓名、部门、工号" | 生成 .xlsx 文件 | 文件可下载 + 有表头和数据 |
| BF-3.3 | "把上面的员工信息生成一份 PDF" | 生成 .pdf 文件 | 文件可下载 + 内容正确 |
| BF-3.4 | "在刚才的 Word 周报里追加一段：下周计划是开始钢板切割" | 修改已有文件 | 新增内容出现在文档末尾 |

**通过标准**: ≥ 3/4

---

## BF-4：本地 Agent 文件操作

**用户故事**: 工程师连接本地 Agent，让 AI 操作本地文件和执行命令。

**前置条件**: Client Agent 已配对并在线。

### 验收用例

| 编号 | 操作 | 预期结果 | 判定标准 |
|------|------|---------|---------|
| BF-4.1 | 进入本地模式 | 显示"本地模式 已连接" | 指示器可见 |
| BF-4.2 | "列出当前工作目录下的文件" | AI 返回文件列表 | 文件名与实际一致 |
| BF-4.3 | "在当前目录创建一个文件 test-bf4.txt，内容写'业务验收测试'" | 本地创建文件 | 文件实际存在 + 内容正确 |
| BF-4.4 | "读取刚才创建的 test-bf4.txt" | AI 返回文件内容 | 内容为"业务验收测试" |
| BF-4.5 | "删除 test-bf4.txt" | 文件被删除 | ls 确认文件不在了 |
| BF-4.6 | 退出本地模式 | 指示器消失，切回云端 | 后续对话走云端 |

**通过标准**: 6/6。本地模式是"做"的核心能力，不允许失败。

---

## BF-5：会话管理与记忆

**用户故事**: 用户在多个项目之间切换，需要每个会话独立、历史可恢复。

### 验收用例

| 编号 | 操作 | 预期结果 | 判定标准 |
|------|------|---------|---------|
| BF-5.1 | 新建一个会话，发送"记住：我的项目叫海运数据分析" | AI 确认记住 | 正常回复 |
| BF-5.2 | 再新建一个会话，发送"我的项目叫什么？" | AI 不知道（会话隔离） | 不返回"海运数据分析" |
| BF-5.3 | 切回第一个会话，发送"我的项目叫什么？" | AI 回答"海运数据分析" | 上下文恢复正确 |
| BF-5.4 | 刷新页面 | 聊天记录完整保留 | 之前的消息都在 |
| BF-5.5 | 删除第二个会话 | 会话消失，不影响第一个 | 列表更新 + 第一个会话正常 |
| BF-5.6 | 连续创建 5 个会话 | 系统正常 | 侧边栏列表正确 |

**通过标准**: 6/6

---

## BF-6：完整工作场景（跨功能组合）

**用户故事**: 员工的一个完整工作流程，涉及对话 + 数据分析 + 文档生成。

这是最重要的验收——模拟真实用户的完整工作日。

### 场景：生产经理做月度总结

**操作步骤**（按顺序执行，中间不切换会话）：

1. 发送"你好，我是生产部的经理，需要你帮我做本月的工作总结"
   - **预期**: AI 询问具体内容或提供模板

2. 发送"本月数据如下：A产线产量500件、B产线600件、C产线450件。合格率分别是98%、95%、99%"
   - **预期**: AI 理解并回应

3. 发送"用表格展示这些产线数据"
   - **预期**: Workbench 打开，显示 3 行表格

4. 发送"再用柱状图对比三条产线的产量"
   - **预期**: Workbench 显示柱状图

5. 发送"根据以上数据，帮我生成一份 Word 版的月度生产总结报告"
   - **预期**: 生成 .docx 文件，包含数据和分析

6. 发送"最后总结一下B产线合格率偏低的原因可能有哪些"
   - **预期**: AI 给出合理的分析（基于上下文）

**判定标准**：
- 6 步中 ≥ 5 步成功 = 通过
- 第 3、4 步（Workbench）必须至少有 1 步成功
- 第 5 步（Word 生成）必须成功
- AI 在第 6 步必须记得之前的数据（上下文连贯）

---

## 执行方式

### 不是自动化测试

这次**不用 Playwright**。用真实浏览器，人工操作，人工判断。原因：
1. 自动化测试判断不了"AI 回复是否有用"，只能判断"元素是否存在"
2. 业务验收需要人的判断——"这个回答对用户有帮助吗？"
3. 要截图记录每一步的实际界面

### 执行流程

1. 确认环境就绪：Docker 容器运行、后端 :3000、前端 :5173、Client Agent 配对
2. 按 BF-1 到 BF-6 顺序执行
3. 每步截图 + 记录 AI 实际回复
4. 遇到问题**不跳过**，记录详细情况后继续

### 报告格式

```markdown
## BF-X 验收结果

| 编号 | 结果 | AI 实际回复摘要 | 截图 |
|------|------|---------------|------|
| BF-X.1 | ✅/❌ | "..." | [附图] |

通过率: X/Y
问题汇总: [具体描述]
```

---

## 门禁标准

| 链路 | 最低通过 | 权重 | 说明 |
|------|---------|------|------|
| BF-1 基础对话 | 6/6 | 基础 | 对话都不行，产品不存在 |
| BF-2 Workbench | ≥ 4/5 | 核心 | "看"的能力，产品核心差异化 |
| BF-3 Office | ≥ 3/4 | 重要 | 文档生成是高频需求 |
| BF-4 本地 Agent | 6/6 | 核心 | "做"的能力，另一个核心差异化 |
| BF-5 会话管理 | 6/6 | 基础 | 多会话是基本功能 |
| BF-6 完整场景 | ≥ 5/6 | 决定性 | 这才是真正的产品验收 |

**总门禁**: BF-1 到 BF-5 全部达标 + BF-6 通过 = 产品验收通过

**任何一个链路未达标** → 定位问题 → 修复 → 重新验收该链路

---

## 验收后的决定

### 验收通过
→ 代码合并 main → 标记 v1.0-beta → 可以开始规划下一阶段

### 验收未通过
→ 逐项修复不达标项 → 重新验收 → 直到通过

**没有时间表压力。做对比做快重要。**

---

## 关于产品方向

验收完成后，我会基于结果重新评估产品方向。当前"看/做/管"三位一体的定位是否正确，要等我们确认"看"和"做"真正能用之后再说。

**先把手上的事做好，再谈扩展。**

**开始执行。**
